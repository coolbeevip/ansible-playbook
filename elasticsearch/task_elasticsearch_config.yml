- name: include vars
  include_vars: "vars_elasticsearch.yml"

# 初始化目录
- name: create others directories
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ es_user }}"
    group: "{{ es_group }}"
    mode: "2750"
  with_items:
    - "{{ es_log_dir }}"
    - "{{ es_data_dir }}"
    - "{{ es_heap_dump_path }}"
    - "{{ es_temp_dir }}"
  become: yes
  check_mode: no

# 上传配置文件
- name: copy configuration file
  template:
    src: "/ansible-playbook/elasticsearch/config/elasticsearch.yml.j2"
    dest: "{{ es_home_dir }}/{{ es_tar_unzip_dir }}/config/elasticsearch.yml"
  check_mode: no
- name: copy jvm file
  template:
    src: "/ansible-playbook/elasticsearch/config/jvm.options.j2"
    dest: "{{ es_home_dir }}/{{ es_tar_unzip_dir }}/config/jvm.options"
  check_mode: no
- name: copy gc options
  copy:
    src: "/ansible-playbook/elasticsearch/config/jvm.options.d/gc.options"
    dest: "{{ es_home_dir }}/{{ es_tar_unzip_dir }}/config/jvm.options.d/gc.options"
  check_mode: no
- name: copy log4j file
  copy:
    src: "/ansible-playbook/elasticsearch/config/log4j2.properties"
    dest: "{{ es_home_dir }}/{{ es_tar_unzip_dir }}/config"
  check_mode: no
