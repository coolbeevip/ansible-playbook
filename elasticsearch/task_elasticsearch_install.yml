- name: check elasticsearch tar exists
  stat:
    path: /opt/elasticsearch-7.8.1-linux-x86_64.tar.gz
  register: stat_result
- name: upload elasticsearch
  synchronize:
    src: /ansible-playbook/elasticsearch-7.8.1-linux-x86_64.tar.gz
    dest: /opt/elasticsearch-7.8.1-linux-x86_64.tar.gz
  check_mode: no
  when: not stat_result.stat.exists

- name: check elasticsearch exists
  stat:
    path: /opt/elasticsearch-7.8.1
  register: stat_result
- name: upload elasticsearch
  shell: |
    cd /opt
    tar zxf elasticsearch-7.8.1-linux-x86_64.tar.gz
  check_mode: no
  when: not stat_result.stat.exists

- name: create configuration directory
  file:
    path: "{{ es_conf_dir }}"
    state: directory
    owner: root
    group: "{{ es_group }}"
    #mode: "2750"

- name: create PID directory
  file:
    path: "{{ es_pid_dir }}"
    state: directory
    owner: "{{ es_user }}"
    group: "{{ es_group }}"
    #mode: "755"

- name: create others directories
  file:
    path: "{{ item }}"
    state: directory
    owner: "{{ es_user }}"
    group: "{{ es_group }}"
    #mode: "2750"
  with_items:
    - "{{ es_log_dir }}"
    - "{{ es_data_dirs }}"

# - name: copy configuration file
# - name: copy default file
# - name: copy jvm.options file
# - name: copy log4j2.properties file
